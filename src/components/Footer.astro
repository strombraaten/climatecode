---
import Default from '@astrojs/starlight/components/Footer.astro';
import type { Props } from '@astrojs/starlight/props';
---

<Default {...Astro.props}>
  <slot />
</Default>

<div id="wcb" class="carbonbadge wcb-d"></div>
<script src="https://unpkg.com/website-carbon-badges@1.1.3/b.min.js" defer
></script>

<style>
  .carbonbadge {
    display: flex;
    justify-self: start;
  }
</style>

<script is:inline>
  window.StarlightThemeProvider = (() => {
    const storedTheme =
      typeof localStorage !== 'undefined' &&
      localStorage.getItem('starlight-theme');
    const theme =
      storedTheme ||
      (window.matchMedia('(prefers-color-scheme: light)').matches
        ? 'light'
        : 'dark');
    document.documentElement.dataset.theme =
      theme === 'light' ? 'light' : 'dark';

    // Remove 'wcb-d' class if theme is light
    const carbonBadge = document.getElementById('wcb');
    if (theme === 'light') {
      carbonBadge.classList.remove('wcb-d');
    }

    return {
      updatePickers(theme = storedTheme || 'auto') {
        document
          .querySelectorAll('starlight-theme-select')
          .forEach((picker) => {
            const select = picker.querySelector('select');
            if (select) select.value = theme;
          });
      },
    };
  })();
</script>
